<div class="page-container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <header class="header">
    <button class="back-btn" (click)="goBack()">â†</button>
    <h1 class="title">ä»»åŠ¡è¯¦æƒ…</h1>
    <button class="menu-btn" (click)="toggleActionMenu()">â‹¯</button>
  </header>

  <!-- åŠ è½½çŠ¶æ€ -->
  <div class="loading-container" *ngIf="isLoading">
    <div class="loading-spinner">åŠ è½½ä¸­...</div>
  </div>

  <!-- ä»»åŠ¡è¯¦æƒ…å†…å®¹ -->
  <div class="detail-container" *ngIf="!isLoading && task">
    <!-- ä»»åŠ¡åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <div class="detail-card">
      <div class="detail-header">
        <h2 class="detail-title">{{ task.title }}</h2>
        <div class="detail-status">
          <span class="status-badge" [class]="getStatusClass()">
            {{ getStatusText() }}
          </span>
          <span class="priority-badge" [class]="getPriorityClass(task.priority)">
            {{ getPriorityText(task.priority) }}
          </span>
        </div>
      </div>
      
      <!-- ä»»åŠ¡æè¿° -->
      <div class="detail-section" *ngIf="task.description">
        <div class="section-title">ä»»åŠ¡æè¿°</div>
        <div class="section-content">{{ task.description }}</div>
      </div>

      <!-- æ—¶é—´ä¿¡æ¯ -->
      <div class="detail-section">
        <div class="section-title">æ—¶é—´ä¿¡æ¯</div>
        <div class="time-info">
          <div class="time-row">
            <span class="time-label">åˆ›å»ºæ—¶é—´ï¼š</span>
            <span class="time-value">{{ formatCreatedAt(task.createdAt) }}</span>
          </div>
          <div class="time-row" *ngIf="task.dueDate">
            <span class="time-label">æˆªæ­¢æ—¶é—´ï¼š</span>
            <span class="time-value" [class.overdue]="isOverdue()">
              {{ formatDueDate(task.dueDate) }}
            </span>
          </div>
          <div class="time-row" *ngIf="task.completedAt">
            <span class="time-label">å®Œæˆæ—¶é—´ï¼š</span>
            <span class="time-value">{{ formatCompletedAt(task.completedAt) }}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œæŒ‰é’® -->
    <div class="quick-actions">
      <button class="action-btn primary" (click)="toggleTaskStatus()">
        <span class="btn-icon">{{ task.status === 'completed' ? 'â†º' : 'âœ“' }}</span>
        <span class="btn-text">{{ task.status === 'completed' ? 'æ ‡è®°æœªå®Œæˆ' : 'æ ‡è®°å®Œæˆ' }}</span>
      </button>
      
      <button class="action-btn secondary" (click)="editTask()">
        <span class="btn-icon">âœ</span>
        <span class="btn-text">ç¼–è¾‘ä»»åŠ¡</span>
      </button>
      
      <button class="action-btn secondary" (click)="duplicateTask()">
        <span class="btn-icon">âŠ•</span>
        <span class="btn-text">å¤åˆ¶ä»»åŠ¡</span>
      </button>
      
      <button class="action-btn secondary" (click)="setReminder()">
        <span class="btn-icon">â°</span>
        <span class="btn-text">è®¾ç½®æé†’</span>
      </button>
    </div>

    <!-- å±é™©æ“ä½œåŒºåŸŸ -->
    <div class="danger-zone">
      <button class="danger-btn" (click)="deleteTask()">
        <span class="btn-icon">ğŸ—‘</span>
        <span class="btn-text">åˆ é™¤ä»»åŠ¡</span>
      </button>
    </div>
  </div>

  <!-- æ“ä½œèœå• -->
  <div class="action-menu-overlay" *ngIf="showActionMenu" (click)="closeActionMenu()"></div>
  <div class="action-menu" *ngIf="showActionMenu" (click)="$event.stopPropagation()">
    <button class="menu-item" (click)="editTask(); closeActionMenu()">
      <span class="menu-icon">âœ</span>
      ç¼–è¾‘ä»»åŠ¡
    </button>
    <button class="menu-item" (click)="duplicateTask(); closeActionMenu()">
      <span class="menu-icon">âŠ•</span>
      å¤åˆ¶ä»»åŠ¡
    </button>
    <button class="menu-item" (click)="setReminder(); closeActionMenu()">
      <span class="menu-icon">â°</span>
      è®¾ç½®æé†’
    </button>
    <div class="menu-divider"></div>
    <button class="menu-item danger" (click)="deleteTask(); closeActionMenu()">
      <span class="menu-icon">ğŸ—‘</span>
      åˆ é™¤ä»»åŠ¡
    </button>
  </div>
</div>