<div class="min-h-screen bg-gray-100 p-4">
  <div class="max-w-[640px] mx-auto">
    <!-- 页面标题 -->
    <div class="text-center mb-8 p-6 bg-white rounded-xl shadow-sm">
      <h1 class="text-2xl font-semibold text-gray-800 m-0 mb-2">API 接口测试</h1>
      <p class="text-sm text-gray-500 m-0">点击下方按钮测试接口，结果请查看浏览器控制台</p>
    </div>

    <!-- 测试任务 ID 输入 -->
    <div class="flex items-center gap-3 p-4 mb-4 bg-white rounded-lg shadow-sm">
      <label for="taskId" class="text-sm font-medium text-gray-700 whitespace-nowrap">测试任务 ID</label>
      <input
        id="taskId"
        type="number"
        class="w-[100px] px-3 py-2 border border-gray-300 rounded-md text-sm outline-none focus:border-blue-500 transition-colors"
        [value]="testTaskId()"
        (input)="testTaskId.set($any($event.target).value)"
        min="1"
      />
      <span class="text-xs text-gray-400">创建任务成功后自动更新</span>
    </div>

    <!-- 测试按钮列表 -->
    <div class="flex flex-col gap-3">
      <div
        *ngFor="let item of testItems; let i = index"
        class="flex items-center justify-between p-4 bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow"
        [class.border-l-4]="loadingIndex() === i"
        [class.border-blue-500]="loadingIndex() === i"
      >
        <div class="flex items-center gap-3 flex-1 min-w-0">
          <span
            class="shrink-0 px-2.5 py-1 rounded text-xs font-semibold font-mono"
            [ngClass]="getMethodColor(item.method)"
          >{{ item.method }}</span>
          <span class="font-mono text-sm text-gray-600 truncate">{{ item.path }}</span>
        </div>
        <button
          class="shrink-0 flex items-center gap-1.5 px-4 py-2 bg-blue-500 text-white rounded-md text-sm font-medium cursor-pointer hover:bg-blue-600 disabled:opacity-60 disabled:cursor-not-allowed transition-colors"
          [disabled]="loadingIndex() !== null"
          (click)="item.action()"
        >
          @if (loadingIndex() === i) {
            <span class="block w-4 h-4 border-2 border-white/30 border-t-white rounded-md animate-spin"></span>
            <span>请求中...</span>
          } @else {
            @if (getItemState(i) === 'success') {
              <span class="text-emerald-500">✓</span>
              <span>成功</span>
            } @else if (getItemState(i) === 'error') {
              <span class="text-red-500">✕</span>
              <span>重试</span>
            } @else {
              <span>测试</span>
            }
          }
        </button>
      </div>
    </div>

    <!-- 控制台提示 -->
    <div class="mt-6 p-4 bg-gray-800 rounded-md text-center">
      <p class="m-0 text-sm text-gray-400">📌 打开浏览器开发者工具（F12）查看控制台日志</p>
    </div>
  </div>
</div>
