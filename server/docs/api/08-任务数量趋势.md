# 任务数量趋势

## 接口信息

- **URL**: `/api/stats/trend`
- **方法**: `GET`
- **描述**: 获取每日新增和完成任务数趋势

## 请求参数

### Query参数

| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| range | Integer | 否 | 7 | 统计时间范围（天数），例如7表示近7天 |

## 请求示例

```bash
# 查询近7天趋势（默认）
curl http://localhost:8080/api/stats/trend

# 查询近30天趋势
curl "http://localhost:8080/api/stats/trend?range=30"
```

```javascript
// 查询近7天趋势
fetch('http://localhost:8080/api/stats/trend?range=7')
  .then(response => response.json())
  .then(data => console.log(data));
```

## 响应示例

### 成功响应

```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "completionRate": null,
    "completionRateByPriority": null,
    "trendData": [
      {
        "date": "2025-11-08",
        "createdCount": 0,
        "finishedCount": 0
      },
      {
        "date": "2025-11-09",
        "createdCount": 2,
        "finishedCount": 1
      },
      {
        "date": "2025-11-10",
        "createdCount": 5,
        "finishedCount": 3
      },
      {
        "date": "2025-11-11",
        "createdCount": 1,
        "finishedCount": 2
      },
      {
        "date": "2025-11-12",
        "createdCount": 3,
        "finishedCount": 1
      },
      {
        "date": "2025-11-13",
        "createdCount": 0,
        "finishedCount": 0
      },
      {
        "date": "2025-11-14",
        "createdCount": 2,
        "finishedCount": 1
      }
    ],
    "unfinishedCount": null,
    "finishedCount": null
  }
}
```

## 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| completionRate | Double | 此接口不返回，为null |
| completionRateByPriority | Map | 此接口不返回，为null |
| trendData | Array | 趋势数据数组，按日期升序排列 |
| unfinishedCount | Long | 此接口不返回，为null |
| finishedCount | Long | 此接口不返回，为null |

### trendData数组元素说明

| 字段 | 类型 | 说明 |
|------|------|------|
| date | String | 日期，格式：YYYY-MM-DD |
| createdCount | Long | 当日新增任务数 |
| finishedCount | Long | 当日完成任务数 |

## 业务规则

1. 统计时间范围：从当前时间往前推range天
2. 数据按日期升序排列
3. 如果某天没有新增或完成任务，对应数量为0
4. 新增任务数基于createTime统计
5. 完成任务数基于finishTime统计

## 数据说明

- **createdCount**：当日创建的任务数量（基于createTime）
- **finishedCount**：当日完成的任务数量（基于finishTime）
- **date**：日期格式为YYYY-MM-DD，例如"2025-11-14"

## 注意事项

1. 趋势数据包含统计时间范围内的每一天，即使某天没有数据也会返回（数量为0）
2. 日期格式为YYYY-MM-DD，便于前端绘制图表
3. 建议range值不超过90天，以保证查询性能
4. 可以用于绘制折线图，对比每日新增和完成任务数

## 使用场景

- 用于展示任务数量趋势折线图
- 用于分析任务创建和完成的规律
- 用于生成数据报表

## 前端图表示例

```javascript
// 使用ECharts绘制趋势图
const trendData = response.data.trendData;
const dates = trendData.map(item => item.date);
const createdCounts = trendData.map(item => item.createdCount);
const finishedCounts = trendData.map(item => item.finishedCount);

// 配置图表
const option = {
  xAxis: {
    type: 'category',
    data: dates
  },
  yAxis: {
    type: 'value'
  },
  series: [
    {
      name: '新增任务',
      type: 'line',
      data: createdCounts
    },
    {
      name: '完成任务',
      type: 'line',
      data: finishedCounts
    }
  ]
};
```

