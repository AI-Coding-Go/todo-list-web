# 完成率统计

## 接口信息

- **URL**: `/api/stats/completion`
- **方法**: `GET`
- **描述**: 获取任务完成率统计，支持按优先级统计

## 请求参数

### Query参数

| 参数名 | 类型 | 必填 | 默认值 | 说明 |
|--------|------|------|--------|------|
| range | Integer | 否 | 7 | 统计时间范围（天数），例如7表示近7天 |

## 请求示例

```bash
# 查询近7天完成率（默认）
curl http://localhost:8080/api/stats/completion

# 查询近30天完成率
curl "http://localhost:8080/api/stats/completion?range=30"
```

```javascript
// 查询近7天完成率
fetch('http://localhost:8080/api/stats/completion?range=7')
  .then(response => response.json())
  .then(data => console.log(data));
```

## 响应示例

### 成功响应

```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "completionRate": 50.0,
    "completionRateByPriority": {
      "高": 100.0,
      "中": 33.33,
      "低": 0.0
    },
    "trendData": null,
    "unfinishedCount": null,
    "finishedCount": null
    }
}
```

## 响应字段说明

| 字段 | 类型 | 说明 |
|------|------|------|
| completionRate | Double | 总体完成率（百分比），计算公式：已完成任务数/总任务数*100 |
| completionRateByPriority | Map<String, Double> | 按优先级统计的完成率，key为优先级描述（"高"、"中"、"低"），value为完成率百分比 |
| trendData | Array | 此接口不返回，为null |
| unfinishedCount | Long | 此接口不返回，为null |
| finishedCount | Long | 此接口不返回，为null |

## 业务规则

1. 统计时间范围：从当前时间往前推range天
2. 总体完成率 = 已完成任务数 / 总任务数 * 100
3. 按优先级统计：分别计算高、中、低优先级的完成率
4. 如果某个优先级没有任务，完成率为0.0
5. 如果总任务数为0，总体完成率为0.0

## 计算说明

- **总体完成率**：统计时间范围内所有任务的完成率
- **按优先级完成率**：
  - 高优先级完成率 = 高优先级已完成任务数 / 高优先级总任务数 * 100
  - 中优先级完成率 = 中优先级已完成任务数 / 中优先级总任务数 * 100
  - 低优先级完成率 = 低优先级已完成任务数 / 低优先级总任务数 * 100

## 注意事项

1. 完成率为百分比数值，例如50.0表示50%
2. 统计基于任务的创建时间（createTime）
3. 已完成任务的判断基于finishTime在统计时间范围内
4. 建议range值不超过90天，以保证查询性能

## 使用场景

- 用于展示总体任务完成情况
- 用于分析不同优先级的任务完成情况
- 用于生成完成率图表

